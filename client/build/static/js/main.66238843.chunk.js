(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{127:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(37),o=a.n(l),s=(a(70),a(13)),c=a(14),i=a(16),u=a(15),m=a(17),d=(a(72),a(136)),h={login:function(e,t){var a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})};return console.log(a),fetch("/api/login",a).then(E).then(function(e){return e.token&&localStorage.setItem("user",JSON.stringify(e)),e})},logout:p};function p(){localStorage.removeItem("user"),this.props.history.push("/login")}function E(e){return e.text().then(function(t){var a=t&&JSON.parse(t);if(!e.ok){401===e.status&&p();var n=a&&a.message||e.statusText;return Promise.reject(n)}return a})}function f(e){h.logout()}var v=function(){return r.a.createElement("header",null,r.a.createElement("div",{className:"text-center"},r.a.createElement("h1",null,r.a.createElement("a",{href:"/"},"Point of Sale System"))),r.a.createElement(d.a,null,r.a.createElement(d.a.Header,null,r.a.createElement(d.a.Brand,null,r.a.createElement("a",{href:"/"},"POS")),r.a.createElement(d.a.Toggle,null)),r.a.createElement(d.a.Collapse,null,r.a.createElement(d.a.Text,null,r.a.createElement(d.a.Link,{href:"/orders"},"Orders")),r.a.createElement(d.a.Text,{pullRight:!0},r.a.createElement(d.a.Link,{href:"",onClick:f},"Logout")))))},g=a(140),b=a(135),O=a(41),y=a.n(O),S=a(60),j=a(19),w=a(141),N=a(142),k=a(130),C=a(137),I=a(129),T=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(){var e=Object(S.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),h.login(a.state.username,a.state.password).then(function(e){!0===e.success?a.props.history.push("/orders"):(alert("login fail. Please try again."),a.props.history.push("/login"))});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.state={username:"",password:""},a.handleChangeUsername=a.handleChangeUsername.bind(Object(j.a)(Object(j.a)(a))),a.handleChangePassword=a.handleChangePassword.bind(Object(j.a)(Object(j.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(j.a)(Object(j.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"handleChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("div",{className:"col-md-4 col-lg-offset-4"},r.a.createElement(I.a,null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(N.a,{controlId:"usernameText"},r.a.createElement(k.a,null,"Username"),r.a.createElement(C.a,{type:"text",value:this.state.username,placeholder:"Enter Username",onChange:this.handleChangeUsername})),r.a.createElement(N.a,{controlId:"passwordText"},r.a.createElement(k.a,null,"Password"),r.a.createElement(C.a,{type:"password",value:this.state.password,placeholder:"Enter Password",onChange:this.handleChangePassword})),r.a.createElement(w.a,{type:"submit",className:"btn-success"},"Login")))))}}]),t}(r.a.Component),P=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?console.log("Authentication successful"):this.props.history.push("/login"),r.a.createElement("div",null,r.a.createElement("h1",null,"Home"))}}]),t}(r.a.Component),x=a(131);function L(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?{Authorization:"Bearer "+e.token,"Content-Type":"application/json"}:{}}var J=L,_=a(138),D={save_order:function(e){var t={method:"POST",headers:J(),body:JSON.stringify({order:e})};fetch("/api/save_order",t).then(function(e){return e.json()}).then(function(e){return console.log("save",e),{result:e}},function(e){return console.log("save",e),e})},view_order:function(e){var t={method:"POST",headers:J(),body:JSON.stringify({oid:e})};fetch("/api/view_order",t).then(function(e){return e.json()}).then(function(e){return e},function(e){return e})}};var A=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(i.a)(this,Object(u.a)(t).call(this))).viewOrder=function(t){e.setState({showItem:!0,itemId:t})},e.saveOrder=function(e){D.save_order(e)},e.removeItem=function(t){var a=[];for(var n in e.state.data){var r=e.state.data[n];if(r.id!==t)a.push(r);else{var l=r;l.state="closed",e.saveOrder(l)}}e.setState({data:a})},e.state={data:[],showItem:!1},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t={method:"GET",headers:L()};fetch("/api/view_orders",t).then(function(e){return e.json()}).then(function(t){e.setState({data:t.orders})},function(t){e.setState({isLoaded:!0,error:t})})}},{key:"render",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user"));t&&t.token?console.log("Authentication successful"):this.props.history.push("/login");var a=0;return r.a.createElement("div",null,r.a.createElement("h2",null,"Order List"),r.a.createElement(x.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Order ID"),r.a.createElement("th",null,"Customer Name"),r.a.createElement("th",null,"Edit"),r.a.createElement("th",null,"Complete"))),r.a.createElement("tbody",null,this.state.data.map(function(t,n){return a+=1,r.a.createElement("tr",{key:n},r.a.createElement("td",null,a),r.a.createElement("td",null,t.id),r.a.createElement("td",null,t.customer),r.a.createElement("td",null,r.a.createElement(w.a,{bsStyle:"success",type:"submit",onClick:function(){e.viewOrder(t.id)}},"Edit"),e.state.showItem?r.a.createElement(_.a,{to:{pathname:"/order",state:{oid:e.state.itemId}}}):null),r.a.createElement("td",null,r.a.createElement(w.a,{bsStyle:"danger",onClick:function(){e.removeItem(t.id)}},"Pay")))}))),r.a.createElement(w.a,{bsStyle:"primary",onClick:function(){e.props.history.push({pathname:"/order",state:{oid:"new"}})}},"Add New Order"))}}]),t}(r.a.Component),U=a(132),B=a(133),q=a(134),W=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).saveOrder=function(){var e=D.save_order(a.state.order);console.log("order saved",e)},a.changeSubTotal=function(e,t){console.log("e value",e.target.value);var n=a.state.order;n.items[t]=parseInt(e.target.value),a.setState({order:n}),a.updateTotal(),a.saveOrder()},a.removeItem=function(e){var t=[];a.state.items.forEach(function(a){a.id!==e&&t.push(a)});var n=a.state.order;for(var r in n.items)parseInt(r)===e&&delete n.items[r];a.setState({items:t,order:n}),a.updateTotal(),a.saveOrder()},a.selectItemChange=function(e,t){var n=e.target.value,r="";a.state.itemList.forEach(function(e){parseInt(n)===e.id&&(r=e,console.log("hooray"))});for(var l=a.state.items,o=0;o<l.length;o++){var s=l[o];if(isNaN(parseInt(n)))return;if(console.log(t,s.id),r.id===s.id)return void alert("This item is already added");o+1===t&&(l[o]=r)}a.setState({items:l}),a.updateTotal(),a.saveOrder()},a.addItem=function(){var e={},t=a.state.items;e.id="",e.name="",e.price=0,e.qty=1,t.push(e),a.setState({items:t})},a.updateTotal=function(){var e=0;a.state.items.forEach(function(t){isNaN(a.state.order.items[t.id])||isNaN(t.price)||(e+=a.state.order.items[t.id]*t.price)}),a.setState({total:e})},a.state={order:[],items:[],itemList:[],itemOptions:[],total:0},a.updateTotal=a.updateTotal.bind(Object(j.a)(Object(j.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;if("new"!==this.props.location.state.oid){var t={method:"POST",headers:L(),body:JSON.stringify({oid:this.props.location.state.oid})};fetch("/api/view_order",t).then(function(e){return e.json()}).then(function(t){e.setState({order:t.order,items:t.items,itemList:t.itemList});var a=[];a.push(r.a.createElement("option",null," Select a Item ")),t.itemList.forEach(function(e){a.push(r.a.createElement("option",{key:e.id,value:e.id}," ",e.name," "))}),e.setState({itemOptions:a}),e.updateTotal()},function(t){console.log(t),e.setState({isLoaded:!0,error:t})})}else{var a={method:"GET",headers:L()};fetch("/api/get_items",a).then(function(e){return e.json()}).then(function(t){e.setState({itemList:t.items});var a=[];a.push(r.a.createElement("option",null," Select a Item ")),t.items.forEach(function(e){a.push(r.a.createElement("option",{key:e.id,value:e.id}," ",e.name," "))}),e.setState({itemOptions:a,order:{id:"",customer:"",state:"open",items:{}}}),e.updateTotal(),e.addItem()},function(t){console.log(t),e.setState({isLoaded:!0,error:t})})}}},{key:"render",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user"));t&&t.token?console.log("Authentication successful"):this.props.history.push("/login");var a=0;return console.log(this.state.items),r.a.createElement("div",{className:"col-md-6 col-lg-offset-3"},r.a.createElement("h2",null,"Order Details"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"col-lg-6 col-lg-offset-3"},r.a.createElement(N.a,null,r.a.createElement("label",null,"Order ID : "),r.a.createElement("input",{className:"form-control",type:"text",id:"id_input",value:this.state.order.id,placeholder:"Enter orderID",onChange:function(t){var a=t.target.value,n=e.state.order;n.id=a,e.setState({order:n})}})),r.a.createElement(N.a,null,r.a.createElement(k.a,null,"Customer Name"),r.a.createElement("input",{type:"text",id:"name_input",className:"form-control",defaultValue:this.state.order.customer,placeholder:"Enter customer",onChange:function(t){var a=t.target.value,n=e.state.order;n.customer=a,e.setState({order:n})}}))),r.a.createElement(x.a,{striped:!0,bordered:!0,condensed:!0,hover:!0,onChange:function(t){return e.updateTotal(t)}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Item ID"),r.a.createElement("th",null,"Item Name"),r.a.createElement("th",null,"Price"),r.a.createElement("th",{"data-value":"test2"},"Qty"),r.a.createElement("th",null,"Sub total"),r.a.createElement("th",null,"Remove"))),r.a.createElement("tbody",null,this.state.items.map(function(t,n){return a+=1,console.log(t),""===t.id?r.a.createElement("tr",{key:n},r.a.createElement("td",null,a),r.a.createElement("td",null,t.id),r.a.createElement("td",null,r.a.createElement("select",{className:"form-control",onChange:function(t){return e.selectItemChange(t,a)},id:a},e.state.itemOptions)),r.a.createElement("td",null,t.price),r.a.createElement("td",{className:"col-md-2"},r.a.createElement("input",{min:"0",id:t.name,type:"number",className:"form-control",value:e.state.order.items[t.id],placeholder:"Enter qty",onChange:function(a){return e.changeSubTotal(a,t.id)}})),isNaN(t.price*e.state.order.items[t.id])?r.a.createElement("td",null,0):r.a.createElement("td",null,t.price*e.state.order.items[t.id]),r.a.createElement("td",null,r.a.createElement(w.a,{bsStyle:"danger",onClick:function(){e.removeItem(t.id)}},"X"))):r.a.createElement("tr",{key:n},r.a.createElement("td",null,a),r.a.createElement("td",null,t.id),r.a.createElement("td",null,t.name),r.a.createElement("td",null,t.price),r.a.createElement("td",{className:"col-md-2"},r.a.createElement("input",{min:"0",id:t.name,type:"number",className:"form-control",value:e.state.order.items[t.id],placeholder:"Enter qty",onChange:function(a){return e.changeSubTotal(a,t.id)}})),isNaN(t.price*e.state.order.items[t.id])?r.a.createElement("td",null,0):r.a.createElement("td",null,t.price*e.state.order.items[t.id]),r.a.createElement("td",null,r.a.createElement(w.a,{bsStyle:"danger",onClick:function(){e.removeItem(t.id)}},"X")))}))),r.a.createElement("br",null),r.a.createElement(U.a,{className:"show-grid"},r.a.createElement(B.a,{md:2},r.a.createElement(w.a,{className:"btn-success",onClick:function(){e.addItem()}},"Add Item")),r.a.createElement(B.a,{md:2,mdOffset:4},r.a.createElement(k.a,null,"Total  :   ")," "),r.a.createElement(B.a,{md:2},r.a.createElement(C.a,{type:"number",value:this.state.total})),r.a.createElement(B.a,{md:2},r.a.createElement(w.a,{className:"btn-success",onClick:function(){e.saveOrder()}},"Save Order")))))}}]),t}(r.a.Component),G=Object(q.a)(W),H=function(){return r.a.createElement(I.a,null,r.a.createElement("h1",null,"Oops"),r.a.createElement("p",null,"We couldn't find what you are looking for."))},M=function(){return r.a.createElement("main",null,r.a.createElement(g.a,null,r.a.createElement(b.a,{exact:!0,path:"/",component:P}),r.a.createElement(b.a,{path:"/login",component:T}),r.a.createElement(b.a,{path:"/orders",component:A}),r.a.createElement(b.a,{path:"/order",component:G}),r.a.createElement(b.a,{component:H})))},R=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={hasError:!1,error:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0,error:e})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(I.a,null,r.a.createElement("h1",null,"Oops"),r.a.createElement("h3",null," Something went wrong. :("),r.a.createElement("p",null,this.state.error)):this.props.children}}]),t}(r.a.Component),X=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(i.a)(this,Object(u.a)(t).call(this))).state={items:[]},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(R,null,r.a.createElement(v,null),r.a.createElement(M,null)))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var z=a(139);o.a.render(r.a.createElement(z.a,null,r.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},64:function(e,t,a){e.exports=a(127)},70:function(e,t,a){},72:function(e,t,a){}},[[64,2,1]]]);
//# sourceMappingURL=main.66238843.chunk.js.map